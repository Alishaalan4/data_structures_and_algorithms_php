<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Number Pattern Exam — 10 Questions — 15 Minutes (Corrected)</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;line-height:1.45;margin:0;padding:20px;background:#f5f7fb;color:#111}
  .container{max-width:820px;margin:0 auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 8px 24px rgba(20,30,60,.06)}
  h1{margin:0 0 8px;font-size:20px}
  .meta{color:#555;margin-bottom:12px}
  .timer{font-weight:700;color:#b22222}
  .question{margin-top:14px}
  .qtext{font-weight:600;margin-bottom:8px;white-space:pre-wrap}
  .options{display:flex;flex-direction:column;gap:8px}
  .option{display:flex;align-items:center;gap:12px;padding:10px;border-radius:8px;border:1px solid #e9edf5;cursor:pointer;background:#fbfdff}
  .option:hover{background:#f0f6ff}
  .option input{transform:scale(1.05)}
  .nav{display:flex;justify-content:space-between;margin-top:16px}
  button{padding:10px 14px;border-radius:8px;border:0;background:#0b63d6;color:#fff;cursor:pointer}
  button.secondary{background:#6c757d}
  button:disabled{opacity:.5;cursor:not-allowed}
  .results{margin-top:18px}
  .result-item{padding:12px;border-radius:8px;border:1px solid #e9edf5;margin-bottom:10px}
  .correct{background:#e9f7ef;border-color:#bdeacb}
  .incorrect{background:#fff6f6;border-color:#f3c6c6}
  .explain{color:#333;margin-top:8px}
  .score{font-size:18px;font-weight:700;margin-top:12px}
  .small{font-size:13px;color:#555}
</style>
</head>
<body>
<div class="container">
  <h1>Number Pattern Exam</h1>
  <div class="meta">
    <span><strong>10 questions</strong> • <strong>3 options each</strong> • <strong>15 minutes</strong></span>
    <span style="float:right">Question <span id="currentIndex">0</span>/10</span>
  </div>

  <div id="startScreen">
    <p class="small">Click <strong>Start Exam</strong> to begin the 15-minute timer. Use 1/2/3 to answer and ←/→ to navigate. The exam auto-submits when time expires.</p>
    <div>
      <button id="startBtn">Start Exam</button>
      <button id="previewBtn" class="secondary">Preview Questions</button>
    </div>
  </div>

  <div id="examArea" style="display:none">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div class="timer">Time left: <span id="time">15:00</span></div>
      <div class="small">Answered: <span id="answeredCount">0</span>/10</div>
    </div>

    <div id="questionBox" class="question" aria-live="polite"></div>

    <div class="nav">
      <div>
        <button id="backBtn" class="secondary">Back</button>
        <button id="nextBtn">Next</button>
      </div>
      <div>
        <button id="submitBtn" class="secondary">Submit Exam</button>
      </div>
    </div>
  </div>

  <div id="previewArea" style="display:none;margin-top:12px">
    <h3>Question Preview</h3>
    <ol id="previewList"></ol>
    <div style="margin-top:8px"><button id="closePreview" class="secondary">Close Preview</button></div>
  </div>

  <div id="resultsArea" style="display:none">
    <h3>Results</h3>
    <div id="scoreBox" class="score"></div>
    <div id="resultsList" class="results"></div>
  </div>
</div>

<script>
const questions = [
{q:"1. Find the next number: 2, 4, 8, 16, ?", opts:["32","30","31"], ans:0, expl:"Powers of two: 2^1,2^2,2^3,2^4 → next 2^5 = 32."},
{q:"2. Find the missing term: 3, 5, 9, 17, 33, ?", opts:["65","63","66"], ans:0, expl:"Each term doubles the previous and adds 1: 3→5(+2),5→9(+4),9→17(+8),17→33(+16), next +32 → 65."},
{q:"3. Which completes: 1, 1, 2, 3, 5, 8, ?", opts:["12","13","11"], ans:1, expl:"Fibonacci sequence: next = 5+8 = 13."},
{q:"4. Next in series: 5, 9, 17, 33, 65, ?", opts:["129","127","131"], ans:0, expl:"Differences double each step (+4,+8,+16,+32); next +64 → 65+64 = 129."},
{q:"5. Find the next: 7, 10, 8, 11, 9, 12, ?", opts:["10","13","14"], ans:0, expl:"Two interleaved sequences: 7,8,9,10,... and 10,11,12,... Next term is the next of the first subsequence → 10."},
{q:"6. Number pattern: 4, 6, 9, 6, 14, 6, 19, ? ", opts:["6","24","25"], ans:1, expl:"Sequence alternates a fixed 6 and an increasing sequence 4,9,14,19 (+5 each). After 19 comes 24."},
{q:"7. Find the next: 2, 3, 5, 8, 12, 17, ?", opts:["23","22","24"], ans:0, expl:"Differences are +1,+2,+3,+4,+5; next difference +6 → 17+6 = 23."},
{q:"8. Sequence: 1, 4, 9, 16, 25, ?, next", opts:["36","30","49"], ans:0, expl:"Perfect squares: 1^2,2^2,3^2,4^2,5^2 → next 6^2 = 36."},
{q:"9. Find the missing: 2, 6, 12, 20, 30, ?", opts:["42","36","40"], ans:0, expl:"These are n(n+1): 1·2,2·3,3·4,4·5,5·6 → next 6·7 = 42."},
{q:"10. Which completes: 3, 6, 11, 18, 27, 38, ?", opts:["51","50","49"], ans:0, expl:"Differences are 3,5,7,9,11 (odd numbers). Next difference 13 → 38+13 = 51."}
];

let state = {index:0, answers:Array(questions.length).fill(null), started:false, timerId:null, endTime:null};

const startBtn = document.getElementById('startBtn');
const previewBtn = document.getElementById('previewBtn');
const startScreen = document.getElementById('startScreen');
const examArea = document.getElementById('examArea');
const questionBox = document.getElementById('questionBox');
const currentIndexEl = document.getElementById('currentIndex');
const timeEl = document.getElementById('time');
const backBtn = document.getElementById('backBtn');
const nextBtn = document.getElementById('nextBtn');
const submitBtn = document.getElementById('submitBtn');
const answeredCountEl = document.getElementById('answeredCount');
const resultsArea = document.getElementById('resultsArea');
const resultsList = document.getElementById('resultsList');
const scoreBox = document.getElementById('scoreBox');
const previewArea = document.getElementById('previewArea');
const previewList = document.getElementById('previewList');
const closePreview = document.getElementById('closePreview');

function renderQuestion(i){
  const item = questions[i];
  currentIndexEl.textContent = i+1;
  const selected = state.answers[i];
  let html = `<div class="qtext">${i+1}. ${item.q.replace(/^\d+\.\s*/,'')}</div><div class="options">`;
  item.opts.forEach((opt, idx) => {
    const checked = selected===idx ? 'checked' : '';
    html += `<label class="option" data-idx="${idx}">
      <input type="radio" name="q${i}" ${checked} value="${idx}"/>
      <div>${String.fromCharCode(65+idx)}. ${opt}</div>
    </label>`;
  });
  html += `</div>`;
  questionBox.innerHTML = html;
  questionBox.querySelectorAll('.option').forEach(el=>{
    el.addEventListener('click', ()=>{
      const idx = Number(el.getAttribute('data-idx'));
      state.answers[i] = idx;
      updateAnsweredCount();
      const input = el.querySelector('input');
      input.checked = true;
    });
  });
  backBtn.disabled = (i===0);
  nextBtn.disabled = (i===questions.length-1);
}

function updateAnsweredCount(){
  const count = state.answers.filter(a=>a!==null).length;
  answeredCountEl.textContent = count;
}

function startExam(){
  startScreen.style.display = 'none';
  previewArea.style.display = 'none';
  examArea.style.display = 'block';
  state.started = true;
  state.index = 0;
  renderQuestion(0);
  updateAnsweredCount();
  state.endTime = Date.now() + 15*60*1000;
  state.timerId = setInterval(()=>{
    const remaining = state.endTime - Date.now();
    if(remaining <= 0){
      timeEl.textContent = "00:00";
      clearInterval(state.timerId);
      autoSubmit();
      return;
    }
    const mm = Math.floor(remaining/60000);
    const ss = Math.floor((remaining%60000)/1000);
    timeEl.textContent = String(mm).padStart(2,'0') + ":" + String(ss).padStart(2,'0');
  }, 250);
}

function autoSubmit(){
  examArea.style.display = 'none';
  showResults(true);
}

function submitExam(){
  if(!confirm("Submit exam now? You cannot change answers after submission.")) return;
  clearInterval(state.timerId);
  examArea.style.display = 'none';
  showResults(false);
}

function showResults(timedOut){
  resultsArea.style.display = 'block';
  resultsList.innerHTML = '';
  let score = 0;
  questions.forEach((q,i)=>{
    const user = state.answers[i];
    const correct = q.ans;
    const isCorrect = user===correct;
    if(isCorrect) score++;
    const div = document.createElement('div');
    div.className = 'result-item ' + (isCorrect ? 'correct' : 'incorrect');
    const userText = user===null ? 'No answer' : String.fromCharCode(65+user);
    div.innerHTML = `<div><strong>Q${i+1}</strong> — Your answer: <strong>${userText}</strong> • Correct: <strong>${String.fromCharCode(65+correct)}</strong></div>
                     <div class="explain">${q.expl}</div>`;
    resultsList.appendChild(div);
  });
  scoreBox.textContent = `Score: ${score} / ${questions.length}` + (timedOut ? " (auto-submitted when time expired)" : "");
}

/* Preview */
previewBtn.addEventListener('click', ()=>{
  previewList.innerHTML = '';
  questions.forEach((q,i)=>{
    const li = document.createElement('li');
    li.textContent = q.q.replace(/^\d+\.\s*/,'');
    previewList.appendChild(li);
  });
  previewArea.style.display = 'block';
});
closePreview.addEventListener('click', ()=> previewArea.style.display='none');

/* Navigation */
backBtn.addEventListener('click', ()=>{
  if(state.index>0){ state.index--; renderQuestion(state.index); }
});
nextBtn.addEventListener('click', ()=>{
  if(state.index<questions.length-1){ state.index++; renderQuestion(state.index); }
});
submitBtn.addEventListener('click', submitExam);
startBtn.addEventListener('click', startExam);

/* Keyboard support */
document.addEventListener('keydown', (e)=>{
  if(!state.started) return;
  if(e.key==='ArrowLeft'){ backBtn.click(); }
  if(e.key==='ArrowRight'){ nextBtn.click(); }
  if(['1','2','3'].includes(e.key)){
    const idx = Number(e.key)-1;
    state.answers[state.index] = idx;
    updateAnsweredCount();
    renderQuestion(state.index);
  }
});
</script>
</body>
</html>